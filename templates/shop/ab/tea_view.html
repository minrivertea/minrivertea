{% extends "base.html" %}
{% load thumbnail %}
{% load django_static %}

{% block metadescription %}{% if tea.meta_description %}{{ tea.meta_description|safe }}{% else %}{{ tea.name }} - {{ tea.description|safe }}{% endif %}{% endblock %}
{% block pagetitle %}{{ tea.meta_title }}{% endblock %}

{% block extrajs %}
<script>
$(function() {

$(".scrollable").scrollable();

$(".items img").hover(function() {

	// see if same thumb is being clicked
	if ($(this).hasClass("active")) { return; }

	// calclulate large image's URL based on the thumbnail URL (flickr specific)
	var url = $(this).attr("alt");
	
	// get handle to element that wraps the image and make it semi-transparent
	var wrap = $("#image_wrap").fadeTo("medium", 0.5);

	// the large image from www.flickr.com
	var img = new Image();
    
	// call this function after it's loaded
	img.onload = function() {

		// make wrapper fully visible
		wrap.fadeTo("fast", 1);

		// change the image
		wrap.find("img").attr("src", url);	

	};

	img.src = url;

	// activate item
	$(".items img").removeClass("active");
	$(this).addClass("active");

}).filter(":first").hover();
});

// this controls the notify form email behaviour
$('#id_email').focus(function() {
	if ($(this).val() == "Your email address") {
		$(this).css('color', '#333');
		$(this).val("");
	}
	else {
	  return;	
	}
});

$('#id_email').focusout(function() {
	if ($(this).val() == "") {
		$(this).val("Your email address");
		$(this).css('color', '#999');
	}
});

$(document).ready( function() {
	$('a#explain-prices').fancybox({
    	'autoDimensions':true,
    });
});


</script>

<script type="application/javascript" src="{% staticfile '/js/lightbox/jquery.fancybox-1.3.4.pack.js' %}"></script>
{% endblock %}

{% block extracss %}
<link rel="stylesheet" href="{% staticfile '/css/fancybox/jquery.fancybox-1.3.4.css' %}" />
<style type="text/css">
div.more-info {
  padding-left: 0px;
  margin-bottom: 15px;
  padding-top: 15px;	
  border-top: 1px solid #e1e1e1;
  margin-top: 15px;
}

#home-banner p.normal {
    font-size: 15px;
    width: 500px;
}

h3.more-info {
    margin-bottom:10px;
    margin-top: -3px;
    padding-bottom: 0;
}

div.right-links h3.more-info {
  margin-bottom: 15px;	
  float: left;
  width: 220px;
}


div.other-teas {
    float: left;
    margin: 0 0 10px 10px;
    width: 500px;
}

div.other-tea {
    border-bottom: 1px solid white;
    color: #666666;
    float: left;
    font-size: 0.9em;
    margin-bottom: 20px;
    padding-bottom: 15px;
    width: 460px;
}

div.other-tea.last {
  border-bottom: none;	
}

div.other-tea div.image {
  float: left;
  margin-right: 15px;
}

div.other-tea div.text {
  margin-top: 2px;	
}

div.other-teas h3 {
  font-size: 1.5em;
  text-shadow: 1px 1px #fff;
  margin-bottom: 20px;
}

div.product-photos-small {
    float: left;
    margin: 15px 0 15px 0;
    width: 420px;
    text-align: right;
}

div.tea-top div.main-image div.product-photos-small img {
    border-radius: 5px 5px 5px 5px;
    float: left;
    margin: 0 5px 0 0;
    padding: 2px;
    border: 1px solid #fff;
}

div.product-photos-small img:hover {
  cursor: pointer;
  opacity: 0.8;	
}

div.product-photos-small img.active {
  padding: 2px;
  border: 1px solid #4e9350;	
}

div.product-photos-small p {
    float: left;
    font-size: 13px;
    line-height: 1.3em;
    margin-top: 20px;
    text-align: right;
    width: 100px;
}

div.right-links {
  padding-top: 0px;	
  float: left;
}

div.right-links ul {
    margin: 0 0 0 0;
    padding-left: 15px;
}

div.right-links ul li {
    color: #666666;
    font-size: 13px;
    list-style-type: square;
    margin-bottom: 10px;
    padding-left: 0;
}

div.tea-top {
    float: left;
    margin: 10px 0 10px;
    padding-bottom: 30px;
}

div.tea-top div.description p {
  font-size: 21px;
  color: #333;	
  margin: 0 0 10px 0;
}

div.tea-top div.main-image {
  width: 520px;
  float: left;
  margin-right: 20px;	
}

div.tea-top div#prices {
    float: left;
    margin-top: 10px;
    padding-top: 0px;
    width: 420px;
}

div.tea-top div#prices div.price {
    float: left;
    margin: 0 20px 0 10px;
    width: 170px;
}

div.tea-top div#prices div.price.large {
  width: 380px;
}


div.tea-top div#prices div.price.large p.price-description {
  width: 100px;
  float: left;
  margin-left: 10px;
  margin-bottom: 0px;	
}

div.tea-top div#prices div.price.large div.message {
  width: 110px;
  float: left;	
  padding-top: 6px;
}

div.tea-top div#prices div.price.last {
 margin-right: 0;
}

div.tea-top a.button {
    float: left;
    font-size: 16px;
    left: -5px;
    margin: 10px 0 0;
    position: relative;
    width: 150px;
    color: #19761C;
}

div.tea-top a.button.single {
    float: right;
    left: -5px;
    margin: 0;
}

div.tea-top div.main-image img {
  border: 10px solid #fff;
  box-shadow: 0 2px 4px #999;	
}

div.tea-top div.tea-description {
  float: left;
  width: 330px;
  margin-top: 0px;
  margin-bottom: 0px;
}

div.tea-top div.tea-description p {
  font-size: 13px;	
  margin-top: 0;
}

div.price-text {
    color: #EE6464;
    float: left;
    font-size: 28px;
    font-weight: bold;
    height: 23px;
    letter-spacing: -1px;
    margin: 0;
    position: relative;
    top: -4px;
    width: 200px;
}

div.message {
    border: medium none;
    line-height: 1.2em;
    margin-bottom: 0;
    margin-left: 10px;
    margin-top: 5px;
    padding: 3px 0 0;
    float: left;
    width: 150px;
}

div.message p {
  line-height: 1.5em;	
}

div.message a {
  color: #EE6464;	
}

div.message img {
    float: left;
    margin-right: 3px;
    position: relative;
    top: 2px;
}

div.message p {
  font-size: 13px;
  margin: 0; 
  color: #19761C;	
}

table.details {
    color: #333;
    font-size: 13px;
    margin-top: 10px;
    width: 660px;
}

table.details tr {
  padding-bottom: 10px;	
}

table.details td {
  padding: 15px;	
  background-color: #fff;
}

table.details td a {
  font-size: 12px;	
}

table.details td.left {
  padding-right: 10px;
  background-color: #e1e1e1;
}

ul.reviews {
    list-style-type: none;
    padding-left: 20px;
    margin-bottom: 0;
    margin-bottom: 20px;
}

ul.reviews li {
    margin-bottom: 20px;
    padding-bottom: 15px;
}

ul.reviews li span {
  color: #BE373A;	
}

h3.small {
  font-size: 15px;	
}

div.product-photos-small p.helper {
    background: url("/images/helper.png") no-repeat scroll left top transparent;
    color: #f1f1f1;
    float: left;
    font-family: Helvetica;
    font-size: 10px;
    height: 7px;
    margin: 0 0 0 30px;
    padding: 15px 8px;
    text-align: left;
    width: 130px;
}

p.price {
    color: #444;
    float: left;
    font-size: 32px;
    font-weight: bold;
    letter-spacing: -1px;
    line-height: 1em;
    margin: 0;
    text-shadow: 0 2px 2px #FFFFFF;
}

p.price span.grey {
  color: #555;
  font-weight: bold;
  font-size: 20px;
  text-shadow: none;
}



p.price-description {
    color: #333333;
    float: left;
    font-size: 12px;
    line-height: 1.2em;
    margin: 0 0 0 5px;
    width: 90px;
    position: relative;
}


div.fb-recommend {
  margin-top: 20px;
  float: left;	
}

div.coming-soon {
    float: right;
    height: 85px;
    padding: 15px 15px;
    width: 410px;
}

div.coming-soon p {
  font-size: 12px;
  margin: 0 0 10px 0;
}

div.coming-soon span {
  font-weight: bold;
  font-family: Helvetica, Arial, sans-serif;	
  color: #b91f1f;
}

div.coming-soon span.green {
  color: #1C7600;
  line-height: 1.6em;
  font-size: 20px;
}

div.coming-soon input {
  float: left;
  color: #999;	
}

div.coming-soon input.submit {
    background-color: #1C7600;
    border-left: medium none;
    color: #FFFFFF;
    font-family: Helvetica,sans-serif;
    font-weight: bold;
    height: 32px;
    padding: 7px;
    width: 70px;
}

div.coming-soon input.submit:hover {
  cursor: pointer;	
  background-color: #359318; 
}

#facebook {
  float: left;
  width: 80px;
}

#google {
  margin-bottom: 10px;
  float: left;
  width: 80px;
}

.tea-top #explain-prices-full {
  display: none;	
  position: absolute;
  height: 0;
}

#explain-prices-full h3 {
  position: relative;
  top: 3px;
  margin-bottom: 30px;	
}

#explain-prices-full p {
  margin: 0 0 10px 0;	
}

#explain-prices-full span.pound {
    background-color: green;
    border-radius: 25px 25px 25px 25px;
    color: #FFFFFF;
    display: block;
    float: left;
    font-size: 30px;
    font-weight: bold;
    margin-right: 10px;
    padding: 10px 16px 9px 17px;
    position: relative;
    top: 0;
}	

#price-helper {
    float: right;
    height: 25px;
    margin: 25px 40px 0 0;
    width: auto;
}

a#explain-prices {
  font-size: 11px;	
  margin-bottom: 15px;
  float: left;
  font-weight: bold;
}

a#explain-prices span {
    background-color: green;
    border-radius: 10px;
    color: #FFFFFF;
    font-weight: bold;
    padding: 3px 5px 2px 5px;
    position: relative;
    left: -0px;
    top: -1px;
    font-size: 10px;
}

a#explain-prices:hover span {
  background-color: #FFAEAE;	
}

</style>
{% endblock %}



{% block content %}


<div id="banner">
  <div class="super">

    <ul class="rss">
		<li id="google">
			<g:plusone></g:plusone>
			<script type="text/javascript">
			  (function() {
			    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
			    po.src = 'https://apis.google.com/js/plusone.js';
			    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
			  })();
			</script>
		</li>
    	<li id="facebook">
		    <div id="fb-root"></div>
		    <script src="http://connect.facebook.net/en_US/all.js#appId=234100573279411&amp;xfbml=1"></script>
		    <fb:like href="http://www.minrivertea.com/teas/{{ tea.slug }}" send="false" layout="button_count" width="80" show_faces="true" font="">
		    </fb:like>
		</li>
	</ul>
	
	<h1>{{ tea.name }} Chinese tea</h1>


  </div>
</div>


<div id="main-text-wide">
  <div class="super">
     	
	<div class="tea-top">
		<div class="main-image">
			<div id="image_wrap">	
				<img src="http://static.flowplayer.org/tools/img/blank.gif" width="500" height="331" /> 
			</div>
					<div class="product-photos-small">
			<div class="scrollable">   
			   <div class="items">
  			    <div>
  			        {% thumbnail tea.image "50x50" crop="center" as im %}
  			    		{% thumbnail tea.image "500x331" crop="center" as im_large %}
						<img class="product-small" alt="{{ im_large.url }}" title="{{ tea.description }}" src="{{ im.url }}"/></a>
						{% endthumbnail %}
					{% endthumbnail %}
					
					{% if tea.image_2 %}
  			    	{% thumbnail tea.image_2 "50x50" crop="center" as im %}
  			    		{% thumbnail tea.image_2 "500x331" crop="center" as im_large %}
						<img class="product-small" alt="{{ im_large.url }}" title="{{ tea.image_2_caption }}" src="{{ im.url }}"/></a>
						{% endthumbnail %}
					{% endthumbnail %}
					{% endif %}
					
					{% if tea.image_3 %}
					{% thumbnail tea.image_3 "50x50" crop="center" as im %}
  			    		{% thumbnail tea.image_3 "500x331" crop="center" as im_large %}
						<img class="product-small" alt="{{ im_large.url }}" title="{{ tea.image_3_caption }}" src="{{ im.url }}"/></a>
						{% endthumbnail %}
					{% endthumbnail %}
					{% endif %}
					
					{% if tea.image_4 %}
					{% thumbnail tea.image_4 "50x50" crop="center" as im %}
  			    		{% thumbnail tea.image_4 "500x331" crop="center" as im_large %}
						<img class="product-small" alt="{{ im_large.url }}" title="{{ tea.image_4_caption }}" src="{{ im.url }}"/></a>
						{% endthumbnail %}
					{% endthumbnail %}
					{% endif %}
					
					{% if tea.image_5 %}
					{% thumbnail tea.image_5 "50x50" crop="center" as im %}
  			    		{% thumbnail tea.image_5 "500x331" crop="center" as im_large %}
						<img class="product-small" alt="{{ im_large.url }}" title="{{ tea.image_5_caption }}" src="{{ im.url }}"/></a>
						{% endthumbnail %}
					{% endthumbnail %}
					{% endif %}
      			</div>
      		  </div>
      		</div>
		</div><!-- end product photos small -->
		</div>
		
		<div class="description">{{ tea.body_text|safe }}</div>
		
		<div id="prices">
	      {% if tea.coming_soon %}
		  	<div class="coming-soon">
		  	    {% if notify_message %}
		  	    	<span class="green">Thanks - as soon as this product is available again, we'll notify you by email!</span>
		  	    {% else %}
		  		<span class="">Sorry, this tea is out of stock :(</span><br/>
		  		<p>But we'd be happy to notify you when this tea becomes available again.</p>
		  		<form method="post" action="">
		  			<input type="text" name="email" id="id_email" value="Your email address"/>
		  			<input type="submit" value="Submit" class="submit"/>
		  		</form>
		  		{% endif %}
		  	</div>
		  {% else %}
			{% ifequal prices.count 1 %}
				{% for price in prices %}
		    	  <div class="price large">
		    		<p class="price">{{ price.price_unit }}{{ price.price|floatformat }}</p> 
		    		<p class="price-description">{{ price.description }}</p>
					<a title="Add 1 {{ tea.name }} ({{ price.weight|floatformat:'2' }}{{ price.weight_unit }}) to your basket" href="{% url add_to_basket price.id %}" class="button single">Add to basket +</a>
            		{% if message %}
            		{% ifequal thing.item.weight price.weight %}
	  				<div class="message">
	  					<img src="{% staticfile '/images/tick.png' %}">
						<p>Added! <a href="{% url basket %}">Checkout &raquo;</a></p>
					</div>
		  			{% endifequal %}
		  			{% endif %}
              	</div>
           		{% endfor %}

			{% else %}
		    	{% for price in prices %}
		    	  <div class="price{% if forloop.last %} last{% endif %}">
		    		<p class="price">{{ price.price_unit }}{{ price.price|floatformat }}</p> 
		    		<p class="price-description">{{ price.description }}</p>
					<a title="Add 1 {{ tea.name }} ({{ price.weight|floatformat }}{{ price.weight_unit }}) to your basket" href="{% url add_to_basket price.id %}" class="button">Add to basket +</a>
            		{% if message %}
            		{% ifequal thing.item.weight price.weight %}
	  				<div class="message">
	  					<img src="{% staticfile '/images/tick.png' %}">
						<p>Added! <a href="{% url basket %}">Checkout &raquo;</a></p>
					</div>
		  			{% endifequal %}
		  			{% endif %}
            	  </div>
           		{% endfor %}
           	{% endifequal %}
          {% endif %}
        </div>
        
        <div id="price-helper">
			<a id="explain-prices" href="#explain-prices-full"><span>£</span> Explaining our prices</a>		
			<div id="explain-prices-full" style="width: 600px; padding: 30px;">
				<span class="pound">£</span>
				<h3>We strongly believe our prices reflect the best available value around - here's why:</h3>
				<ul>
				<li><strong>We're the only independent UK tea store actually based in China</strong> - there are no middlemen making extra-profits, and we pay local market rates for our tea, not 'tourist' rates.</li>	
				<li><strong>You pay for tea, not packaging.</strong> Our packaging is intentionally simple, and costs less than 3% of the price you pay.</li>
				<li><strong>Each cup costs less than 25p.</strong> Because high quality loose-leaf teas can be rebrewed 3-5 times, a 100g bag of tea can make around 50-80 big mugs!</li>
				</ul>
				<p>Plus, we offer a <strong>no questions asked refund</strong> if you're not satisfied, and a flat rate postage fee of £3. If you order over £50, shipping is totally free.</p>
				
				
			</div>
		</div>

	</div><!-- end top product info div -->

	
	<div id="right">   
	
		<div class="info">
		<img src="{% staticfile '/images/tea-view-right.png' %}"/>
		</div>
		           	

           	
           	<div class="info">
			<h3 class="small">Take a look at our other teas</h3>
				{% for other in others %}
			 		<p class="mail">
			 			<a href="{{ other.get_absolute_url }}"><span class="link"></span></a>
			 				{% thumbnail other.image "60x45" crop="center" as im%}
			 				<img alt="{{ other.description }}" class="mail-icon" src="{{ im.url }}" />
			 				{% endthumbnail %}
			 			<a class="title" href="{% url tea_view other.slug %}" title="{{ other.name }} - another one of our great Chinese teas">{{ other.name }}</a>
			 			<br/>{{ other.super_short_description }}
			 		</p>
			 	{% endfor %}
			</div>
           	
      	</div>
           	
  



	<div id="left">
		{% if tea.get_reviews %}
			<h2>Customer reviews for this tea ({{ tea.get_reviews.count }})</h2>
			<ul class="reviews">
			{% for review in tea.get_reviews %}
				<li><em>"{{ review.short_text }}"</em> <br/><span>{{ review.first_name }} {{ review.last_name }}</span></li>
			{% endfor %}
			</ul>
		{% endif %}  

	
		<h2>More information about this tea</h2>
		{{ tea.long_description|safe }}
		{% if ga_is_on %}
		<div class="fb-recommend">
		<div id="fb-root"></div><script src="http://connect.facebook.net/en_US/all.js#appId=102598969829350&amp;xfbml=1"></script><fb:like href="http://www.minrivertea.com{{ tea.get_absolute_url }}" send="false" width="450" show_faces="false" action="recommend" font=""></fb:like>
		</div>
		{% endif %}
	
	

	
	
			
						 
</div>

</div>
</div>
{% endblock %}
