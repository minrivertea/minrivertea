{% extends base_template %}
{% load thumbnail i18n convert_weights %}

{% block pagetitle %}{% trans 'Checkout - confirm and pay' %}{% endblock %}

{% block extrajs %}
<script type="text/javascript">

</script>

{% endblock %}

{% block extracss %}
<style type="text/css">


#tools {
  display: none;   
}

#basket {
  min-height: 300px;
  padding-bottom: 30px;
}

#bottom {
  float: left;
  width: 100%;
  margin: 40px 0 0 0;   
}

#bottom .info {
  border-right: 1px dashed #e1e1e1;
  padding: 0 20px; 
  width: 285px  
}

#bottom .info:first-child {
  padding-left: 0;
}

#bottom .info:last-child {
  padding-right: 0;
  border-right: none; 
  width: 300px;  
}

#bottom .info input {
  width: 100%;
  padding: 5px;
  margin-top: 5px;
  font-size: 13px;   
}

#bottom .info #order-url {
    font-family: Courier;
    font-size: 11px;
    margin-top: 5px;
    overflow: hidden;
    width: 90%;
    padding-left: 5px;
}

#bottom .info #order-url:hover {
  overflow: auto; 
  width: 100%;
  overflow: visible;
  background: #fff;
  position: relative;
  z-index: 20;
}

#bottom .info #order-url span {
  width: 550px;
  float: left;
  padding: 5px 0;
  background: #fff;    
}

#items, #address {
  width: 550px;
  margin: 0 auto;
}


table td {
  padding: 0px;	
  border: none;
}

#items table td {
  border-bottom: 1px dashed #e1e1e1;
  padding: 5px 0;   
}

#items table tr:last-child td {
  border-bottom: none;
  padding-bottom: 0;   
}

#address p.address {
  font-size: 15px;
  margin-left: 0px;
}

#address p.pay-on-behalf {
    float: left;
    font-size: 15px;
    width: 280px;
}

#payment {
    width: 550px;
    margin: 30px auto 0;
}


#payment #stripe {
  float: right;   
}

#payment #stripe img {
  float: right;
  margin: 0 0 0px 0;   
}

#payment #stripe .stripe-button-el span {
    font-size: 20px;
    height: 35px;
    padding: 3px 12px 0;
}

#payment #stripe .cards {
  height: 20px;
  width: 79px;
  overflow: hidden;
  display: block;
  float: right;
  background: url('{{ static_url }}images/logo16.jpg') no-repeat -4px -40px;   
}

#payment #stripe form {
  margin: 0 0 10px 0;   
}

#checkout-button {
  width: 820px;
  padding: 0 15px;
  float: left;
  padding: 0;
  margin: 5px 0;   
}

#checkout-button input {
  background: none;
  padding: 0;
  border: none;
  color: #2A8531;
  text-decoration: underline;
  float: left;
  width: auto;
  margin: 10px 0 0 0;
}

#checkout-button input:hover {
  color: #D30000;
  cursor: pointer;   
}



p.checkout {
    float: left;
    font-size: 13px;
    margin: 0 0 10px 0;
    text-align: left;
    width: auto;
}


#wishlist-full p.url {
  background-color: #f1f1f1;
  padding: 10px 15px;	
}

#wishlist-full strong {
  color: #333;	
}

table {
  background: none;   
}

table tr td:first-child {
  background: none;
  width: 320px;   
}

table tr td:last-child {
  width: 50px;
  text-align: right;   
}

p.skip {
  float: right;
  width: 100%;
  text-align: right;   
}

</style>

{% endblock %}

{% block content %}

<div id="mtw">
  <div class="sp">
  
	   <h1>{% if friend %}{% trans 'Complete this order on behalf of' %} {{ order.owner.first_name }} {{ order.owner.last_name }}{% else %}{% trans "Pay and complete your order" %}{% endif %}</h1>
	   {% if not friend %}
       <div id="steps">
            <ul>
                <li class="completed">
                    
                    <div class="icon">
                        <a href="{% url basket %}"><span class="link"></span></a>&#10003;
                    </div>
                    <div class="text">
                        <strong>{% trans 'Your basket' %} </strong>
                    </div>
                </li>
                <li class="completed">
                    <div class="icon">
                        <a href="{% url order_step_one %}"><span class="link"></span></a>&#10003;</div>
                    <div class="text">
                        <strong>{% trans 'Shipping details' %}</strong>
                    </div>
                </li>
                <li class="current">
                    <div class="icon">
                        <a href="{% url order_confirm %}"><span class="link"></span></a>3</div>
                    <div class="text">
                        <strong>{% trans 'Payment' %}</strong>
                    </div>
                </li>
            </ul>
            <div id="line"></div>                
        </div>
    	{% endif %}
   
	<div id="basket">
	<div id="address">
    
        {% if friend %}
        {% url page _('contact_us') as contact_url %}
        <p class="pay-on-behalf">{% blocktrans with order.owner.first_name as fn and order.owner.last_name as ln %}<strong>You are paying on behalf of <span style="text-decoration:underline">{{ fn }} {{ ln }}</span>.</strong> You are purchasing the items listed on the left, which will be sent to the address {{ fn }} provided. You will not receive any further email notifications from us, but you will receive a receipt from Paypal. If you have any questions before you purchase, please <a href="{{ contact_url }}">contact us</a>.{% endblocktrans %}</p>
        {% endif %}

        {% if not friend %}
            <p class="address">
            {% with order.address as address %}
                <strong>{{ order.owner.first_name }} {{ order.owner.last_name }}</strong>, 
                {{ order.owner.email }}<br/>
                {% include "shop/snippets/address_line.html" %}
            {% endwith %}
            </p>
  	   {% endif %}
  	
  	</div>
	
	
				
	<div id="items">
	    {% include 'shop/snippets/order_items.html' %}
		
	</div>

	
  	
  	<div id="payment">
        
        
        
        <!-- STRIPE FORM -->
        <div id="stripe">
        
        <form action="" method="POST">
          <script
            src="https://checkout.stripe.com/checkout.js" class="stripe-button"
            data-key="{{ stripe_public_key }}"
            data-amount="{{ amount_in_cents }}"
            data-email="{{ order.owner.email }}"
            data-name="{{ site_name }}"
            data-description="{% for item in basket.basket_items %}{{ item }}{% if not forloop.last %}, {% endif %}{% endfor %}"
            data-image="{{ static_url }}images/logo-square.jpg"
            data-currency="{{ currency.code }}"
            data-label="{% trans 'Confirm and pay now' %}"
            >
          </script>
        </form>
        
        <img src="{{ static_url }}images/stripe.png"/>
        <div class="cards"></div>
        </div>
        <!-- END STRIPE FORM -->
               
        
    </div>

</div>

<!-- PAYPAL FORM -->
    {% include "shop/snippets/paypal_form.html" %}
<!-- END PAYPAL FORM -->

<div id="bottom">

    <div class="info">
        <h3>{% trans 'Safe and secure payment' %}</h3>
      	<p>{% trans "We accept all major credit/debit cards and Paypal and we're protected by industry standard SSL encryption." %}</p>
    </div>
    
    {% if not friend %}
    <div class="info">
        <h3>{% trans 'Ask a friend to pay' %}</h3>
        <p>{% trans 'Send a friend this link and they can pay for this order for you' %}</p>
        <div id="order-url"><span>{{ site_url }}{% url order_url_friend order.hashkey %}</span></div>
    </div>
    {% endif %}
    
    <div class="info">
        <h3>{% trans 'Problems or questions?' %}</h3>
        {% url finder _('contact-us') as contact_url %}
        <p>{% blocktrans %}We aim to offer first class customer service - if you have ANY problems or questions, <a href="{{ contact_url }}">contact us</a> immediately. We'll respond as quickly as possible, usually within a few hours.{% endblocktrans %}</p>
    </div>


</div>

	
	
	
  </div>
</div>
{% endblock %}
